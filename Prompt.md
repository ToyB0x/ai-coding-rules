# Prompt

## 目次
- [概要と利用方法](#概要と利用方法)
- [ドキュメント作成・更新のルール](#ドキュメント作成更新のルール)
- [進捗管理とセルフモニタリング](#進捗管理とセルフモニタリング)
- [作成・更新すべき資料](#作成更新すべき資料)
  - [プロジェクト/リポジトリのドキュメンテーションガイド](#プロジェクトリポジトリのドキュメンテーションガイド)
  - [プロジェクト理解のための資料](#プロジェクト理解のための資料)
  - [Clineのためのルールとガイドライン](#clineのためのルールとガイドライン)
    - [コミットの提案とメッセージ記録](#コミットの提案とメッセージ記録)
  - [コード理解のための手順とコツ](#コード理解のための手順とコツ)
  - [モノレポ構造のドキュメント](#モノレポ構造のドキュメント)
- [Changelog](#changelog)

## 概要と利用方法

**このドキュメントは、ClineなどのLLMを活用したGitリポジトリでの開発のベストプラクティスをまとめたものです。**

### このファイルについて

> **重要**: このファイルは単一ファイル構造として設計されています。必要な情報はすべてこのファイル内に含まれています。

詳細な編集ガイドラインは `.clinerules/prompt-editing-guidelines.md` に記載されています（参考情報）。

### 目的

本ドキュメントの目的:

- **LLMの効果的な活用**: GitリポジトリにおけるClineなどのLLMの効果的な活用方法を定義
- **ドキュメント管理の標準化**: プロジェクトにおけるドキュメント管理や更新のベストプラクティスを提供
- **AI支援開発の促進**: コミット提案、コード理解など、AI支援開発における様々な側面のガイドラインを整備

### 利用タイミング

> **ポイント**: このドキュメントは任意のタイミングで参照・適用されるべきです

ClineなどのLLMは、**リポジトリ作成初期だけでなく、任意のタイミング**でこの資料を参照し、ベストプラクティスの追加導入や適用を検討すべきです。特に以下のようなタイミングでの参照が推奨されます：

- 新規プロジェクト開始時
- 新機能開発の計画段階
- コードベースのリファクタリング前
- チーム開発プロセスの見直し時
- 既存プロジェクトへのAI支援開発の導入時

### 参照方法

このドキュメントは以下のURLから直接参照することを想定しています：
```
https://raw.githubusercontent.com/ToyB0x/ai-coding-rules/refs/heads/main/Prompt.md
```

**LLMへの指示**: 上記URLを参照してベストプラクティスを取得し、プロジェクトの状況に合わせて適切に適用してください。

## ドキュメント作成・更新のルール

> **LLMが必ず守るべき重要なルール**

**重要**: これらのルールは以下の両方に適用されます：
1. このPrompt.mdガイドラインを自プロジェクトに適用する際のplan-and-progress.md等の作成・更新
2. プロジェクト/リポジトリの全てのドキュメント作成・更新作業

**注意**: これらの基本ルールは、各プロジェクト固有のドキュメンテーションガイドに組み込み、プロジェクト特性に合わせて具体化する必要があります。

| ルール | 説明 |
|-------|------|
| 👤 **人間の確認** | 作成・更新対象のドキュメント一覧を人間に確認し、取捨選択できるようにすること |
| 📅 **日付の記録** | 資料冒頭に更新日と確認日のセクションを配置し、更新日時を記載すること |
| 📋 **変更履歴** | 資料後半にChangelogを配置し、変更内容と変更日時を記載すること |
| 🔄 **最小変更** | 意味的な大きな変化がない場合には確認日のみ更新し、他の内容は変更しないこと |
| ❓ **質問の推奨** | 不明な点があれば遠慮せずに質問すること |
| 🚫 **除外ファイル** | .gitignore等でignoreされているファイルは対象外とすること |

---

## 進捗管理とセルフモニタリング

**LLMの計画立案と進捗追跡**: ClineなどのLLMは、このPrompt.mdの各ルールの適用計画を策定し、進捗状況を自律的に追跡・管理し、`plan-and-progress.md`ファイルに記録してください。これにより、プロジェクトがルールをどのように段階的に適用していくか計画し、その進捗を可視化します。

> **重要**: 計画策定後は必ず人間と内容を調整し、現実的な実装スケジュールと優先順位について合意を得てください。

### plan-and-progress.mdの作成・更新ガイドライン

LLMは初回参照時および重要な作業完了時に`plan-and-progress.md`を作成・更新し、以下の内容を含めてください：

- **適用計画の概要**: 段階的な適用計画と優先順位
- **適用状況の概要**: 全体的な適用率や主要な進捗
- **各セクションごとの計画と状況**: 個々のルールやガイドラインの計画と適用状況（課題、解決策、次のステップを含む）

### 具体的な適用例

以下は、plan-and-progress.mdの具体的な記載例です。この例を参考に、プロジェクトの状況に合わせた進捗管理ドキュメントを作成してください。

```markdown
# Prompt.md計画と進捗状況

更新日: 2025/03/22

## 適用計画の概要

実装期間: 2025/02/01〜2025/05/30
段階的適用方針:
1. 第1フェーズ: 基本ルール確立（〜2025/03/01）
2. 第2フェーズ: 主要ドキュメント整備（〜2025/04/15）
3. 第3フェーズ: 全体最適化と自動化（〜2025/05/30）

## 適用状況の概要

現在の適用率: 45%（9/20項目）
現在のフェーズ: 第2フェーズ（進行中）

主な進捗:
- ドキュメント更新ルールを実装し、日付記録とChangelogを導入
- プロジェクト目的と概要資料を作成
- コミットメッセージ規約を確立

## 各セクションの計画と状況

### 1. 作成・更新すべき資料
| 資料 | 計画 | 状態 | 備考 |
|------|------|------|------|
| 🎯 プロジェクトの目的と概要 | フェーズ1 | ✅ 適用済 | /docs/guide/purpose.md 作成完了 |
| 📚 現行プロダクトのドキュメント | フェーズ2 | ⚠️ 部分適用 | API仕様書は完成、他は作成中 |
| 🗺️ 機能開発ロードマップ | フェーズ2 | 🔄 進行中 | 初版をチームレビュー中 |

#### 課題と次のステップ
- **課題**: APIドキュメントの自動生成と手動更新の不整合
- **解決策**: APIドキュメント生成・更新フローの一元化
- **次のステップ**: 機能開発ドキュメントテンプレートの作成

### 2. Clineのためのルールとガイドライン
| ガイドライン | 計画 | 状態 | 備考 |
|------------|------|------|------|
| 📖 関連ファイルの記録 | フェーズ1 | ✅ 適用済 | すべて整備完了 |
| 💾 コミットの提案とメッセージ記録 | フェーズ1 | ✅ 適用済 | コミットテンプレート導入済み |

#### 課題と次のステップ
- **課題**: チームメンバーによるChangelogの記載漏れ
- **解決策**: PRチェックリストにChangelog確認項目を追加
- **次のステップ**: Changelogの一貫性向上のための施策実施

```


### 更新タイミング

- 初回プロジェクト分析時
- 重要なドキュメント作成・更新後
- ドキュメント体系の大きな変更を行う前後

**重要**: LLMは自律的にこの進捗状況を評価・記録し、改善提案を行うことでプロジェクトの品質向上に貢献してください。時系列での変化を追跡し、改善傾向も可視化することで、プロジェクト全体の健全性を継続的に高めていくことを推奨します。

---

## 作成・更新すべき資料

### プロジェクト/リポジトリのドキュメンテーションガイド

**重要**: 以下のガイドラインに従ってプロジェクト固有のドキュメンテーションを維持してください。

> **ドキュメントルールの実装**: 「ドキュメント作成・更新のルール」セクションで定義された基本ルールを、プロジェクト固有のコンテキストに合わせて具体化し、適用するためのガイドを作成してください。このガイドは独立したファイル（例: `docs/document-guidelines.md`）として作成し、チーム全体で参照できるようにすることを推奨します。

- 本資料・プロンプトの指針や参考例だけでなく、既存のプロジェクトの状況とのバランスを考慮し、プロジェクトごとにカスタマイズした内容を記載
- 人もLLMも常にこのガイドを参照し、プロジェクトのドキュメンテーションを行うことを前提とする
- このガイドと現状のズレを検知した場合、Cline等のLLMは人間に確認し、ガイド・現状資料のどちらかまたは両方の更新を提案すること
- プロジェクト固有の標準テンプレート、命名規則、フォルダ構成、レビュープロセス等を定義すること

### プロジェクト理解のための資料

#### 🎯 プロジェクトの目的と概要資料

**プロジェクトの目的**や各種オンボーディング資料を`/docs/guide/`配下等に作成・更新すること。

**注意**: プロジェクトの目的が見つからない場合、LLMは必ず人間に確認してください。

#### 📚 現行プロダクトのドキュメント

既存プロダクトについて、以下のドキュメントを整備・維持する:

- ユーザーマニュアル/ユーザーガイド（一般ユーザー向けの操作方法や機能説明）
- 機能一覧/仕様書（開発者やステークホルダー向けの詳細な機能説明と仕様）
- API仕様書/インターフェース定義（他システムとの連携方法やAPIエンドポイントの説明）
- アーキテクチャ概要図（技術スタック、システム構成、コンポーネント間の関係性）
- データモデル図/ER図（データ構造や関連性の説明）
- トラブルシューティングガイド（一般的な問題とその解決方法）
- リリースノート/変更履歴（各バージョンでの変更点や新機能の説明）

#### 🗺️ 機能開発ロードマップ

今後の機能開発のロードマップを`/docs/guide/roadmap.md`等に作成・更新する。

**重要**: 以下の場合、LLMは必ず人間に確認してください:
- ロードマップが存在しない場合
- ロードマップの内容が不明な場合
- ロードマップが数週間以上更新されていない場合

#### 📐 機能開発のドキュメント設計

各機能開発に必要なドキュメントの種類、配置場所、作成タイミングなどを定義する。下記は推奨される標準的なドキュメント構成:

##### ドキュメントの種類の例

**Product Requirement Document**
機能の「なぜ」と「何を」を理解するためのドキュメント（機能開発の目的、概要、要件、ユーザーストーリー、先行事例や参考事例、リリースノート等の記載）

**Technical Design Document**
機能の「どのように」を理解するためのドキュメント。人間のキャパシティを考慮して以下のように複数ファイルに分割することを推奨:

| ファイルパス | 内容 |
|------------|------|
| */Technical-Design/README.md | 全体を俯瞰できるIndexや技術的な概要 |
| */Technical-Design/packages/[パッケージ名]/README.md | 既存パッケージの改修ポイント |
| */Technical-Design/packages/[パッケージ名]/implements.md | 変更実装のための詳細設計書 |
| */Technical-Design/packages/[パッケージ名]/tests.md | 変更テストのための詳細設計書 |
| */Technical-Design/architecture.md | パッケージ間の関係性をまとめたアーキテクチャ |
| */Technical-Design/E2E.md | 機能追加に対するE2Eテスト |

*目的や必要な開発ステップに応じて柔軟にドキュメントを追加すること*

##### 開発ステップの例

**標準的な開発フロー**:

1. **要件定義ステップ**: Product Requirement Documentを作成しレビューする
2. **技術検討ステップ**: Technical Design Documentを作成しレビューする
3. **実装ステップ**: Technical Design Documentをもとに、実装、コードレビューを行う
4. **テストステップ**: Technical Design Documentをもとに、テストを実施する
5. **リリースステップ**: Technical Design Documentをもとに、リリースを実施する
6. **振り返りステップ**: 振り返りを実施し、開発フローの改善等を行う
7. **評価ステップ**: 顧客の反応などをもとに将来の機能開発の参考にする

### Clineのためのルールとガイドライン

#### 📖 関連ファイルの記録

> **単一ファイル設計に関する重要な注記**: このPrompt.mdは単一ファイル構造で設計されています。必要な情報はすべてこのファイル内に含まれており、外部参照は推奨されません。

以下は記録目的のみの情報です:

| 補足ファイル | 説明 |
|------------|------|
| `.clinerules/README.md` | ディレクトリの概要 |
| `.clinerules/commit-rules.md` | コミット提案の詳細ルール |
| `.clinerules/prompt-changelog-guide.md` | Changelog記載ガイドライン |
| `.clinerules/prompt-editing-guidelines.md` | Prompt.md編集の方針 |
| `.clinerules/important-docs.md` | プロジェクト重要資料の場所 |

#### 💾 コミットの提案とメッセージ記録

> **コミットルールの重要性**: コミットメッセージの作成と提案には、以下のルールを遵守してください。

**必ず遵守すべき主要ポイント**:

✅ **積極的な提案**: 作業完了時には必ずコミットを提案すること
✅ **標準形式の遵守**: 「種類: 要約」の形式で、詳細な説明と変更ファイル一覧を含めること
✅ **プロンプト履歴の記録**: プロンプト履歴を必ずコミットメッセージに含めること
✅ **ユーザー承認**: コミット提案時にはユーザーの承認を得ること

### 🔍 コード理解のための手順とコツ

以下は、LLMがリポジトリのコードを効率的に理解するための重要なガイドラインです:

#### Repomixの活用

> **Repomixの優先的活用**: コード分析に関する重要な指針です:

- **効率的な理解**: repomixのMCPを利用して大規模コードベースを効率的に理解する
- **パッケージ分析**: 特定パッケージの調査には、repomixによる分析が強く推奨される
- **通信負荷軽減**: 数十ファイル以上のパッケージでは、Repomixを活用して関数シグネチャのみを効果的に分析し、時間短縮
- **柔軟な利用**: リポジトリ全体、特定パッケージ、特定ディレクトリなど様々な階層で利用可能
- **設定確認**: repomixのMCPが未設定の場合は、ユーザにセットアップを促す

### 📦 モノレポ構造のドキュメント

**モノレポ対応**: リポジトリがモノレポ構造の場合、各パッケージのREADMEを適切に作成・更新してください:

- `/apps/web/README.md`
- `/packages/database/README.md`

---

## Changelog

### 2025/03/22 (更新8回目)

- [移動] 「このファイルの設計と基本原則」セクションを簡潔化し、詳細は`.clinerules/prompt-editing-guidelines.md`に移動
- [追加] `.clinerules/prompt-editing-guidelines.md`に「実装と配置についての設計方針」セクションを追加
- [明確化] Prompt.mdと編集ガイドラインの役割分担を整理

### 2025/03/22 (更新7回目)

- [移動] ドキュメント更新の指針を`.clinerules/prompt-editing-guidelines.md`に移動統合
- [整理] 冗長なセクションを削除して全体の構造を簡素化

### 2025/03/22 (更新6回目)

- [修正] 冒頭の更新日・確認日を削除（Prompt.md固有の例外ルールに従い）
- [追加] `.clinerules/prompt-editing-guidelines.md`にPrompt.md固有のフォーマットルールを明記
- [改善] 関連ファイル情報の記載方法を標準化

### 2025/03/22 (更新5回目)

- [整理] ドキュメントの構造を改善し、不要な区切り線を削除
- [改善] Repomixの説明をより簡潔で読みやすく修正
- [強化] 単一ファイル設計の意図を強調した表現に修正
- [改善] 関連ファイルの情報を表形式にまとめて視認性向上

### 2025/03/22 (更新4回目)

- [修正] 単一ファイル構造の設計方針に合わせて外部ファイル参照の表現を修正
- [追加] `.clinerules/prompt-editing-guidelines.md`ファイルを作成して編集方針を明確化
- [改善] 関連ファイルへの言及を「参考情報」として記録する形式に変更

### 2025/03/22 (更新3回目)

- [改善] マークダウン形式を最適化し、見出しレベルと空白行を調整
- [追加] 重要な情報の視覚的強調を統一（アイコン、太字、引用などの一貫した使用）
- [追加] 表形式を導入して情報を整理
- [改善] 全体の流れを改善するためのセクション間の区切り線を追加

### 2025/03/22 (更新2回目)

- [改善] ドキュメント全体の構造を整理し、見出しレベルを最適化
- [追加] LLM向けの明示的な指示を強調表示
- [改善] 説明文を簡潔化し、重要ポイントを強調
- [修正] 単一ファイル設計の意図を明確に説明

### 2025/03/22 (更新1回目)

- [追加] 「このファイルの設計について」セクションを追加し、単一ファイル構造の目的を説明
- [追加] 「参照すべき.clinerules内のファイル」セクションを追加
- [整理] コミットの提案とメッセージ記録セクションを簡潔化し、.clinerules/commit-rules.mdへの参照を明確化
- [改善] ドキュメント構造を整理し、情報の重複を削減

### 2025/03/22

- [削除] 「参考資料: Cline Prompting Guide」セクションを削除
- [追加] 目的や利用方法のセクションを資料前半に追加
- [追加] ドキュメントの目次（TOC）をドキュメント最上段に追加
- [改善] 折りたたみマークダウン記法を廃止し、適切なセクション構造に変更
- [追加] cline が遵守または参考にすべき情報として、LLMが作業完了時に積極的にコミットを提案すべき内容（.clinerules/commit-proposal.md）を追加
- [追加] コミット提案のタイミング、メッセージの構造、含めるべき情報、ユーザーとのインタラクション方法、具体的な例を追加
- [強調] プロンプト履歴をコミットメッセージに含めることの重要性と具体的な記録方法を詳細に説明

### 2025/03/21

- [追加] 作成・更新すべき資料一覧の参考例を追加
- [追加] 「参考資料: Cline Prompting Guide」セクションを追加
- [変更] 作成・更新のルールを明確化

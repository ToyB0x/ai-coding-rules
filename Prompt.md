# 人とLLMが協働するためのドキュメント作成・管理プロセス

## 目的

人とLLMの両方が効率的にプロジェクトを理解し効率的に協働するために、
- どういったテキスト資料や画像資料(以下では「ドキュメント」と呼称)が必要かを提案する
- 効果的にドキュメントを作成・更新、管理するためのガイドラインとプロセスを提案する

## 前提や背景

- 人もLLMもContextサイズの制約があるため必要なドキュメントに効率的にアクセスできるドキュメントを分割・整理する必要がある
- LLMは人間を超えた認識能力を持っているかもしれないが、人間との協働が必要な場合は、人間が理解できるようにドキュメントを作成・更新する必要がある

## 用語

- AI: CLINE やRoo Code などのAI, LLMツールを指す
- ドキュメント: テキスト資料や画像資料を指す。プログラムコードもある種のドキュメントとみなす。
- ドキュメンテーションガイドライン:
  - ドキュメントを作成・更新するためのガイドラインを指す。
  - 必要なドキュメント種別、理想的のドキュメントの配置構造や内容、フォーマット、命名規則などを含む。
  - 各プロジェクトは、プロジェクトの目的や規模に応じて、必要なドキュメンテーションガイドラインを独自に策定する必要がある。
- ドキュメントルール:
  - ドキュメントを作成・更新・管理するためのルールを指す。
  - ドキュメンテーションガイドラインは複数のドキュメントルールから構成される。
  - ドキュメンテーションガイドラインはプロジェクトの目的や規模に応じて独自に策定する必要があるが、ドキュメントルールはプロジェクトの目的や規模に関わらず、一般的に適用可能なルールを指す。
  - ドキュメントルールは複数存在し例えば以下のものがありえる
    - 作成が必要なドキュメント種別を扱うもの
    - ドキュメント配備構造を扱うもの
    - ドキュメントフォーマットを扱うもの
    - ドキュメントの命名規則を扱うもの
    - ドキュメントの内容を扱うもの
    - ドキュメントルールを扱うメタ的なドキュメントルール(ドキュメントルール自体が、ある種のドキュメントである)

TO: Cline, ここにドキュメンテーションガイドライン、ドキュメントルール、ドキュメントの関係性をMermaidで図にして

## 利用フロー

1. ドキュメンテーションガイドラインの策定: あるべき理想状態を宣言的に定義する。以下のサブプロセスが含まれる
  - 本資料等を含むベストプラクティクスの理解
  - 現状の自プロジェクトの理解(特にプロジェクトの目的に応じた特性の理解。小規模プロジェクトと大規模プロジェクトでは必要なドキュメントが異なる)
  - 上記の理解を元に、ドキュメンテーションガイドラインを策定する。多くの場合はドキュメント構造やディレクトリ構造の定義、各種規約やガイドラインの定義を含む。
  - 既にドキュメンテーションガイドラインを策定している場合は、現状のガイドラインの改善が必要かを確認する

2. 現状とのギャップ分析: 上記で策定したドキュメンテーションガイドラインと現状のギャップを分析する。以下のサブプロセスが含まれる
  - 上記で定義したドキュメンテーションガイドラインの把握
  - 現状の自プロジェクトの理解
  - 両者のギャップの分析

3. ドキュメンテーションガイドラインの適用計画の策定: 上記で分析したギャップをどのような手順で埋めるのかを計画する。以下のサブプロセスが含まれる
  - 上記で分析したギャップの理解
  - それぞれのギャップをどのような手順で埋めるのかを計画する
  - 全てのギャップを一度に埋めることは難しいので、優先度をつけて、段階的に埋めることが望ましい。例えばドキュメンテーションガイドラインに含まれる多数のドキュメントルールのうち、適用しやすいものから適用していくなど

4. ドキュメンテーションガイドラインの適用計画の実行: 上記で策定した計画に基づいて改善を実行する。以下のサブプロセスが含まれる。
  - 上記で策定したドキュメンテーションガイドラインの適用計画の理解
  - 現状プロジェクトの理解(計画作成時と現状にズレがある場合に重要)
  - 適用計画に基づいて改善を実行する(計画作成時と現状にズレがある場合、前段階のフローからやり直すことを検討)

5. 定期的な検査と更新: プロジェクトの変化に合わせてドキュメンテーションガイドラインの更新、または再適用を行う。このプロセスは定期的に実施することが望ましい。以下のサブプロセスが含まれる
  - 現状のドキュメンテーションガイドラインの把握
  - ドキュメンテーションガイドラインの改善や調整を適宜行う (特にプロダクトの目的や機能に大きな変化が発生していないか確認を行う)
  - 上記 2. 以降のステップを繰り返す (時間経過により、策定されたガイドラインが遵守されていない状況が発生するので修正する)

## ドキュメンテーションガイドラインと各ドキュメントルールの推奨例

以下に、ドキュメンテーションガイドラインとそこに含まれる複数のドキュメントルールの推奨例を示します。これらはあくまで一例であり、プロジェクトの特性に応じて適宜調整してください。  
なお、以下では本資料を読みやすいように同一ファイルに全体をまとめていますが、実際には各ドキュメントルールやガイドライン自体を含む、多くのドキュメントを個別のファイルに分けて管理することを推奨します。

### ドキュメンテーションガイドライン例
#### 配置場所
- docs/README.md

#### 具体例
  ```markdown
  # ドキュメンテーションガイドライン
  ## ドキュメンテーションガイドラインの目的
  - 人とLLMがドキュメントを作成・更新するためのガイドラインを策定する
  - ...

  ## ドキュメンテーションガイドラインを実現するルールの一覧と概要
  - [ドキュメント種別](docs/doc-types.md): 
    - プロジェクトに必要なドキュメントの種別を定義する
    - ...
  - [ドキュメント配置構造](docs/doc-structure.md): 
    - ドキュメントの配置構造を定義する
    - ...
  - [ドキュメントフォーマット](docs/doc-format.md): 
    - ドキュメントのフォーマットを定義する
    - ...
  - [ドキュメントの更新ルール](docs/doc-update-rules.md): 
    - ドキュメントの更新ルールを定義する
    - ...
  ```
#### 注意事項
- 人とLLMがドキュメンテーションガイドラインを見つけやすいように、プロジェクトのルートディレクトリのREADMEからリンクさせる
- ドキュメンテーションガイドラインには必ずサマリーのセクションと、ここに記載したドキュメントルールのセクションを含める


### ドキュメントルール例: ドキュメント種別の定義
#### 配置場所
- docs/doc-types.md

#### 具体例
  ```markdown
  # ドキュメント種別
  ## 目的
  - プロジェクトに必要なドキュメントの種別を定義する

  ## ドキュメント種別
  ### プロジェクト概要
  - プロジェクトの目的や概要を説明するドキュメント
  - 全プロジェクトメンバーが必ず知っておかなければならない

  ### ロードマップ一覧
  - プロジェクトのロードマップを一覧化したドキュメント
  - 開発予定の機能やリリース予定日などを記載する
  - 詳細は別ファイルへと分割する

  ### ユーザガイド
  - プロジェクトのユーザ向けのドキュメント
  - ユーザがプロジェクトを利用するために必要な情報を記載する

  ### ...
  ```

#### 注意事項
- 人とLLMがドキュメンテーションガイドラインを見つけやすいように、プロジェクトのルートディレクトリのREADMEからリンクさせる
- ドキュメンテーションガイドラインには必ずサマリーのセクションと、ここに記載したドキュメントルールのセクションを含める


### ドキュメントルール例: ドキュメントの配置構造
#### 配置場所
- docs/doc-structure.md

#### 具体例
  ```markdown
  # ドキュメントの配置構造
  ## 目的
  - ドキュメントの配置構造を定義し、人とLLMがドキュメントを発見しやすいようにする

  ## 理想のドキュメント構造
  docs/
  ├── README.md                         # ドキュメントガイドライン
  ├── PLAN.md                       # ドキュメントガイドラインや個々のドキュメントルールの適用計画
  ├── PROGRESS.md                       # ドキュメントガイドラインや個々のドキュメントルールの適用状況
  ├── guide/                            # すべてのガイドのIndex
  │   ├── README.md                     # ガイド全体の目次と導入
  │   ├── developer/                    # 開発者向けガイド
  │   │   ├── README.md                 # 開発者向けガイド目次
  │   │   ├── getting-started/          # 開発環境構築等
  │   │   ├── development-flow/          # 開発フロー関連
  │   │   ├── packages/          # モノレポ内のパッケージの概要など(ほとんどの場合、package.jsonと並置したREADMEへのリンクのみを含む)
  │   │   ├── architecture/             # アーキテクチャ関連
  │   │   │   ├── adr/                  # アーキテクチャ決定記録
  │   │   │   └── ...
  │   │   └── ...
  │   ├── operator/                     # 運用者向けガイド
  │   │   ├── README.md
  │   │   ├── deployment/               # デプロイメント関連
  │   │   ├── monitoring/               # 監視関連
  │   │   ├── maintenance/              # メンテナンス関連
  │   │   └── ...
  │   └── users/                        # ユーザー向けガイド
  │       ├── README.md                 # ユーザー向けガイド目次
  │       ├── basics/                   # 基本操作ガイド
  │       ├── integration/              # 連携関連ガイド
  │       └── ...
  ├── rules/                            # ドキュメントルール (docs/配下の構造と似たような構造であり、それぞれの具体的なドキュメントのルールを定義する)
  │   ├── README.md                     # プロジェクト全体のドキュメントルール一覧と概要
  │   ├── ai/                    # AI関連ドキュメントルール(必ず.clinerules.mdなどから直接リンクされる)
  │   │   ├── README.md                 # AI関連ドキュメントルールの概要
  │   │   ├── config/                   # AIの設定ファイルが存在すること自体の確認など
  │   │   ├── minimum-change/            # コード以外のドキュメントについては、意味的な大きな変化がない場合には確認日のみ更新し、他の内容は変更しないことを記載したドキュメントルール
  │   │   ├── ask/                   # 不明な点があれば遠慮せずに質問することを記載したドキュメントルール
  │   │   ├── commit/                   # AIのコミットメッセージのルール等を記載したドキュメントルール
  │   │   ├── tools/                   # AIが効果的に活用すべきツールについて記載(RepomixなどのMCPをどのタイミングで利用すべきかについて記載)
  │   │   ├── maintenance/            # AIが更新すべきドキュメントや、更新手順、更新時の注意を記載したドキュメントルール
  │   │   └── preparation/                 # AIを利用する上で、配備しておくべきドキュメントや、配備状態の確認方法を記載したドキュメントルール(.clinerules.mdなどについても記載)
  │   ├── guide/                  
  │   │   ├── developer/                  # 開発者向けドキュメントルール
  │   │   │   ├── code/                  # コードファイル自体のドキュメントルール
  │   │   │   ├── package/                  # パッケージモジュールのREADMEのドキュメントルール(パッケージのREADMEを適切に記載するためのルールを記載)
  │   │   │   ├── architecture/            # アーキテクチャのドキュメントルール
  │   │   │   └── development-flow/            # 開発フローのドキュメントルール
  │   │   ├── operator/                  # 運用者向けドキュメントルール
  │   │   └── users/            # ユーザー向けドキュメントルール
  │   ├── documents/                    # ドキュメント全般に関するドキュメントルール
  │   │   ├── README.md                 # ドキュメント全般に関するドキュメントルールの概要
  │   │   ├── maintenance/            # ドキュメントの更新に関するドキュメントルール
  │   │   └── metadata/                 # ドキュメントのメタデータに関するドキュメントルール
  │   │       ├── changelog/            # Changelogのドキュメントルール
  │   │       ├── maintenance-date/     # メンテナンス日付のドキュメントルール
  │   │       ├── relations/            # 参照、被参照ドキュメントの記載と活用方法についてのルール
  │   │       └── ...
  │   └── product/                   # プロダクトに関するドキュメントルール
  └── product/                          # プロダクト情報
      ├── README.md                     # プロダクト概要
      ├── vision.md                     # 長期的なビジョン・ミッション
      ├── product-goal.md               # 製品としての目標
      ├── value-proposition.md          # 価値提案
      ├── members.md                    # 開発メンバー
      ├── features/                     # リリース済み機能
      │   ├── README.md                 # 機能一覧と概要（gitタグのリリース履歴から生成）
      │   └── [機能名]/                  # 個別機能ディレクトリ
      ├── glossary/                     # 用語集 
      │   ├── README.md                 # 用語集の概要
      │   └── terms/                    # 各用語の詳細ページ
      │       └── [用語名].md            # 個別用語の定義
      ├── personas/                     # ユーザーペルソナ定義
      │   └── README.md                 # ペルソナ一覧と詳細
      ├── user-journey/                 # ユーザージャーニーマップ
      │   └── README.md                 # 主要ユーザージャーニーの図解
      ├── metrics/                      # 製品メトリクス
      │    └── README.md                 # KPI・OKRなどの指標定義
      └── roadmaps/                      # 未来の機能計画
          ├── README.md                 # ロードマップ概要とタイムライン
          └── [予定機能名]/              # 予定機能の詳細計画 (リリース完了した機能は、ここからproduct/features/に移動する)
              ├── README.md                  # 全体の概要とドキュメント構造
              ├── requirements/              # 非エンジニア向けドキュメント
              │   ├── README.md              # 要件ドキュメントのガイド
              │   ├── PRD.md                 # 製品要件定義書
              │   └── images/                # 図表・モックアップなど
              └── systems/                   # エンジニア向けドキュメント
                  ├── README.md              # システムドキュメントのガイド
                  ├── overview-specs/        # システム全体設計
                  │   ├── README.md          # 全体設計の概要
                  │   └── system.md          # システム全体設計書
                  ├── package-specs/         # パッケージ仕様書
                  │   ├── README.md          # パッケージ仕様の全体概要
                  │   ├── [パッケージ名]/    # 各パッケージの仕様
                  │   └── ...
                  └── test-specs/            # テスト仕様書
                      ├── README.md          # テスト戦略の概要
                      ├── e2e-tests.md       # E2Eテスト仕様
                      └── unit-tests.md      # ユニットテスト仕様
  ```

#### 注意事項
- 人とLLMがドキュメンテーションガイドラインを見つけやすいように、プロジェクトのルートディレクトリのREADMEからリンクさせる
- clineなどのLLMがみつけやすいように .clinerules.md などにもリンクを貼る

### ドキュメントルール例: ドキュメントルールの適用状況
#### 配置場所
- docs/PROGRESS.md
#### 具体例
  ```markdown
  # ドキュメントルールの適用状況
  ## 目的
  - ドキュメントルールの適用状況を、人とLLMが把握しやすいようにする

  ## 適用状況
  ### メタデータへのチェンジログ記載
  - ルールの場所: rules/documents/metadata/changelog/
  - 最終検査日: 2023/10/01
  - 適用割合: 20%
  - 適用状態の概要:
    - xxx/yyy/配下は全適用済み (2023/10/01)
  - 課題: 
    - チェンジログの記載漏れが多い
    - チェンジログの記載内容が不十分なものが多い
```


### ドキュメントルール例: 開発フローの定義
#### 配置場所
- docs/guide/developer/development-flow/README.md

#### 具体例
  ```markdown
  # 開発フロー
  ## 目的  
    - 開発フローを定義し、開発者とLLMが効率的に開発を行えるようにする

  ## 開発フローの概要
  1. **要件定義**: Product Requirement Documentを作成しレビュー
  2. **技術検討**: Technical Design Documentを作成しレビュー
  3. **実装**: Technical Design Documentをもとに実装、コードレビュー
  4. **テスト**: Technical Design Documentをもとにテスト実施
  5. **リリース**: Technical Design Documentをもとにリリース実施
  6. **振り返り**: 開発フローの改善等を実施
  7. **評価**: 顧客の反応などをもとに将来の機能開発の参考にする
  ```



### ドキュメントルール例: AIのRepomixの活用
#### 配置場所
- docs/rules/ai/tools/repomix/README.md

#### 具体例
  ```markdown
  # AIのRepomixの活用
  ## 目的  
    - AIがRepomixを効果的に活用するためのルールを定義する

  ## Repomixの効果的な活用ルール
  - **効率的な理解**: repomixのMCPを利用して大規模コードベースを効率的に理解する
  - **パッケージ分析**: 特定パッケージの調査には、repomixによる分析が強く推奨される
  - **通信負荷軽減**: 数十ファイル以上のパッケージでは、Repomixを活用して関数シグネチャのみを効果的に分析し、時間短縮
  - **柔軟な利用**: リポジトリ全体、特定パッケージ、特定ディレクトリなど様々な階層で利用可能
  - **設定確認**: repomixのMCPが未設定の場合は、ユーザにセットアップを促す
  ```


### ドキュメントルール例: AIのコミットルール
- docs/rules/ai/commit/README.md

#### 具体例
  ```markdown
  # AIのコミットルール
  ## 目的  
    - AIが適切にコミットの提案とメッセージを記録するためのルールを定義する
  ## Repomixの効果的な活用ルール
  **必ず遵守すべき主要ポイント**: 
  ✅ **積極的な提案**: 作業完了時には必ずコミットを提案すること
  ✅ **標準形式の遵守**: 「種類: 要約」の形式で、詳細な説明と変更ファイル一覧を含めること
  ✅ **プロンプト履歴の記録**: プロンプト履歴を必ずコミットメッセージに含めること
  ✅ **ユーザー承認**: コミット提案時にはユーザーの承認を得ること
  ```

### ドキュメントルール例: AIの設定ファイルルール
- docs/rules/ai/config/README.md

#### 具体例
  ```markdown
  # AIの設定ファイルルール
  ## 目的  
    - AIのセットアップが適切に行われていることを確認する
  ## 設定ファイルの存在確認
  - Clineを使っている場合は、Clineの設定ファイルが存在することを確認する
　- Roo Codeを使っている場合は、Roo Codeの設定ファイルが存在することを確認する

  ## 設定ファイルの内容確認
  - Clineを使っている場合は、Clineの設定ファイルの内容が正しいことを確認する
  - Roo Codeを使っている場合は、Roo Codeの設定ファイルの内容が正しいことを確認する
  ```

# Changelog

## 2025/03/23
- [追加] 大規模に内容改善

## 2025/03/21
- [追加] 初版作成